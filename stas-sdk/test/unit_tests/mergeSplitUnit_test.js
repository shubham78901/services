const bsv = require("bsv");
const { sighash } = require("../../lib/stas");
const {
  mergeSplit,
  mergeSplitWithCallback,
  unsignedMergeSplit,
} = require("../../index");
const privatekeyStr = "Ky5XHRQvYEcEbtGoQQQETbctAgAQKvb3PocfJSnkyHuEj5Nzj1pb";
const privateKey = new bsv.PrivateKey(privatekeyStr);
let addr = "mq7psuJ7Z9h1w4H3YtcCoHx7cPmhVM9UsV";
let invalidAddr = "1MSCReQT9E4GpxuK1K";
let splitTxObj;
let amount1 = 1000;
let amount2 = 2000;
let fundingUtxo = {
  txid: "148c762dca1aa6e6c55fbd7fe0b3cdc00e3f21d7f1304b2349365cfb91bfe5f9",
  vout: 1,
  scriptPubKey: "76a914d1b44a79bbfd9bbcdae85f042ffcb5bc042363f188ac",
  satoshis: 100000,
};

const ownerSignatureCallback = async (tx, i, script, satoshis) => {
  return bsv.Transaction.sighash
    .sign(tx, privateKey, sighash, i, script, satoshis)
    .toTxFormat()
    .toString("hex");
};

beforeEach(() => {
  setup();
});

describe("mergeSplit Unit Tests", () => {
  it("should create mergeSplit hex", async () => {
    const hex = await mergeSplit(
      privateKey,
      getMergeSplitUtxo(splitTxObj),
      addr,
      amount1,
      addr,
      amount2,
      fundingUtxo,
      privateKey
    );
    expect(hex).toBe(expectedHex);
  });

  it("should fail when address 1 is null", async () => {
    await expect(() =>
      mergeSplit(
        privateKey,
        getMergeSplitUtxo(splitTxObj),
        null,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey
      )
    ).rejects.toThrow("Destination address is null");
  });

  it("should fail when address 2 is null", async () => {
    await expect(() =>
      mergeSplit(
        privateKey,
        getMergeSplitUtxo(splitTxObj),
        addr,
        amount1,
        null,
        amount2,
        fundingUtxo,
        privateKey
      )
    ).rejects.toThrow("Destination address is null");
  });

  it("should fail when amount 1 is null", async () => {
    await expect(() =>
      mergeSplit(
        privateKey,
        getMergeSplitUtxo(splitTxObj),
        addr,
        null,
        addr,
        amount2,
        fundingUtxo,
        privateKey
      )
    ).rejects.toThrow("Satoshi value suppled is null");
  });

  it("should fail when amount 2 is null", async () => {
    await expect(() =>
      mergeSplit(
        privateKey,
        getMergeSplitUtxo(splitTxObj),
        addr,
        amount1,
        addr,
        null,
        fundingUtxo,
        privateKey
      )
    ).rejects.toThrow("Satoshi value suppled is null");
  });
});

describe("unsignedMergeSplit unit tests", () => {
  it("unsignedMergeSplit should return tx hex", async () => {
    const expectedHex =
      "010000000324890cbac183e64770f94cded7d3d89ada9127d6e5ee3af164c0f967b2b41cb700000000fd780902e8031469517ff3b4d1cf991a263489a49078b118492f3002d0071469517ff3b4d1cf991a263489a49078b118492f3003c3840114fe5697f24aa6e72a1d5f034121156a81d4f46f955120f9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c145126dd5a1e00000000001976a914c6be9b874f1f44e5a4cd0617698aa3259b0b08bd88ac0000000022dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba1584d5901b80b000000000000ffffffff02423b5f2837239035dff6eaf19c81ee1ccd777e95cf708e36a2b5d2a3931558000000004100000047304402203af4c26c8722d2594469a5ce339b45917d1c4ecd813e6096aec4a895eb1f6d2f02202b6436a21b95d0a46f5004bdaee66f441ff983d49b64fd802538134c2ae8901a412102a3afcd9527b6f3ccfd68f17ae19852168c5202033cff542e6609f567bbe9c1aeffffffff2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21010000006b483045022100df74bfdede946cd441c5b8e3ed8bd48c1fa14a5c0a660b2ca3c1d95101241ca3022064f4d1528f2769122343a3c9172f709288f29a54a81f6caf745fb2f63c6f4868412102ce376e38ef5393d0c20f8cc5e4b7958a50d25dac0287cde2b9e192a0d0815035ffffffff03dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba1584d1d0101000000022b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fd1b0702dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15802dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15803dd5a1e14c6be9b874f1f44e5a4cd0617698aa3259b0b08bd51202b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21004d420601000000a881e572ca976dc6ef3ff647c8c58762ff55d8174cfa3f502b1411e8bbcd286e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632ad2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fda30576a914c0f1de1ee32943002b5b6ab55469c8a74eed7823544d420601000000bdc0b59a0f5c5a6e5a5b131d51cd1249ac66f89cb3f2b1902766ffd30fc76db582a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be824890cbac183e64770f94cded7d3d89ada9127d6e5ee3af164c0f967b2b41cb700000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba15888ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a147013e239733036c3a3d8813a8ec472e045f5f5b60100055441414c540374776fdc05000000000000ffffffff85bc2e978ecf593b4fe0a21ef0d455e32eaaeb3c2699f5a67f8020ad23a717990000000041000000ffffffff24890cbac183e64770f94cded7d3d89ada9127d6e5ee3af164c0f967b2b41cb701000000fd780902e8031469517ff3b4d1cf991a263489a49078b118492f3002d0071469517ff3b4d1cf991a263489a49078b118492f3003c3840114fe5697f24aa6e72a1d5f034121156a81d4f46f955120f9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c140026dd5a1e00000000001976a914c6be9b874f1f44e5a4cd0617698aa3259b0b08bd88ac0000000022dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba1584d5901b80b000000000000ffffffff02423b5f2837239035dff6eaf19c81ee1ccd777e95cf708e36a2b5d2a3931558000000004100000047304402203af4c26c8722d2594469a5ce339b45917d1c4ecd813e6096aec4a895eb1f6d2f02202b6436a21b95d0a46f5004bdaee66f441ff983d49b64fd802538134c2ae8901a412102a3afcd9527b6f3ccfd68f17ae19852168c5202033cff542e6609f567bbe9c1aeffffffff2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21010000006b483045022100df74bfdede946cd441c5b8e3ed8bd48c1fa14a5c0a660b2ca3c1d95101241ca3022064f4d1528f2769122343a3c9172f709288f29a54a81f6caf745fb2f63c6f4868412102ce376e38ef5393d0c20f8cc5e4b7958a50d25dac0287cde2b9e192a0d0815035ffffffff03dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba1584d1d0101000000022b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fd1b0702dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15802dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15803dd5a1e14c6be9b874f1f44e5a4cd0617698aa3259b0b08bd51202b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21004d420601000000a881e572ca976dc6ef3ff647c8c58762ff55d8174cfa3f502b1411e8bbcd286e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632ad2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fda30576a914c0f1de1ee32943002b5b6ab55469c8a74eed7823544d420601000000bdc0b59a0f5c5a6e5a5b131d51cd1249ac66f89cb3f2b1902766ffd30fc76db582a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be824890cbac183e64770f94cded7d3d89ada9127d6e5ee3af164c0f967b2b41cb701000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba15888ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a147013e239733036c3a3d8813a8ec472e045f5f5b60100055441414c540374776fdc05000000000000ffffffff85bc2e978ecf593b4fe0a21ef0d455e32eaaeb3c2699f5a67f8020ad23a717990000000041000000fffffffff9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c140100000000ffffffff03e803000000000000fda30576a91469517ff3b4d1cf991a263489a49078b118492f3088ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14b161f6b2cb286542249ca8c8f835f6c150c222b90100055441414c540374776fd007000000000000fda30576a91469517ff3b4d1cf991a263489a49078b118492f3088ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14b161f6b2cb286542249ca8c8f835f6c150c222b90100055441414c540374776fc3840100000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac00000000";
    const res = await unsignedMergeSplit(
      privateKey.publicKey,
      getMergeSplitUtxo(splitTxObj),
      addr,
      amount1,
      addr,
      amount2,
      fundingUtxo,
      privateKey.publicKey
    );
    expect(res.hex).toBe(expectedHex);
  });
});

// to do merge different owners
describe("mergeSplitWithCallBack Unit Tests", () => {
  it("should return hex mergeSplitWithCallBack", async () => {
    const hex = await mergeSplitWithCallback(
      privateKey.publicKey,
      getMergeSplitUtxo(splitTxObj),
      addr,
      amount1,
      addr,
      amount2,
      fundingUtxo,
      privateKey.publicKey,
      ownerSignatureCallback,
      ownerSignatureCallback
    );
    expect(hex).toBe(expectedHex);
  });

  it("should fail when merging more than two utxos", async () => {
    let mergeSplitUtxo = getMergeSplitUtxo(splitTxObj);
    mergeSplitUtxo.push({
      tx: splitTxObj,
      scriptPubKey: scriptPubKey,
      vout: 3,
    });

    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        mergeSplitUtxo,
        addr,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("This function can only merge exactly 2 STAS tokens");
  });

  it("should fail when merging less than two utxos", async () => {
    let mergeSplitUtxo = [
      {
        tx: splitTxObj,
        scriptPubKey: scriptPubKey,
        vout: 0,
      },
    ];
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        mergeSplitUtxo,
        addr,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("This function can only merge exactly 2 STAS tokens");
  });

  it("should fail when merging utxos with different data", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        getMergeUTxoDiffData(),
        addr,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow(
      "This function only merges utxos with identical data properties"
    );
  });

  it("should fail when merging utxos with different owners", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        getMergeUTxoDiffOwner(),
        addr,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow(
      "This function only merges STAS tokens with the same owner"
    );
  });

  it("should fail when address 1 is invalid", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        getMergeSplitUtxo(splitTxObj),
        invalidAddr,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("Invalid Address string provided");
  });

  it("should fail when address 2 is invalid", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        getMergeSplitUtxo(splitTxObj),
        addr,
        amount1,
        invalidAddr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("Invalid Address string provided");
  });

  it("should fail when token owner private key is null", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        null,
        getMergeSplitUtxo(splitTxObj),
        addr,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("Token owner public key is null");
  });

  it("should fail when mergeUtxo is null", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        null,
        addr,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("MergeUtxos is invalid");
  });

  it("should fail when funding private key is null", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        getMergeSplitUtxo(splitTxObj),
        addr,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        null,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("Payment UTXO provided but payment key is null");
  });

  it("should fail when address 1 is null", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        getMergeSplitUtxo(splitTxObj),
        null,
        amount1,
        addr,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("First destination address is null");
  });

  it("should fail when address 2 is null", async () => {
    await expect(() =>
      mergeSplitWithCallback(
        privateKey.publicKey,
        getMergeSplitUtxo(splitTxObj),
        addr,
        amount1,
        null,
        amount2,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("Second destination address is null");
  });
});

function setup() {
  const splitHex =
    "01000000022b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fd1b0702dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15802dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15803dd5a1e14c6be9b874f1f44e5a4cd0617698aa3259b0b08bd51202b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21004d420601000000a881e572ca976dc6ef3ff647c8c58762ff55d8174cfa3f502b1411e8bbcd286e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632ad2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fda30576a914c0f1de1ee32943002b5b6ab55469c8a74eed782388ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a147013e239733036c3a3d8813a8ec472e045f5f5b60100055441414c540374776fb80b000000000000ffffffff02423b5f2837239035dff6eaf19c81ee1ccd777e95cf708e36a2b5d2a3931558000000004100000047304402203af4c26c8722d2594469a5ce339b45917d1c4ecd813e6096aec4a895eb1f6d2f02202b6436a21b95d0a46f5004bdaee66f441ff983d49b64fd802538134c2ae8901a412102a3afcd9527b6f3ccfd68f17ae19852168c5202033cff542e6609f567bbe9c1aeffffffff2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21010000006b483045022100df74bfdede946cd441c5b8e3ed8bd48c1fa14a5c0a660b2ca3c1d95101241ca3022064f4d1528f2769122343a3c9172f709288f29a54a81f6caf745fb2f63c6f4868412102ce376e38ef5393d0c20f8cc5e4b7958a50d25dac0287cde2b9e192a0d0815035ffffffff03dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba15888ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a147013e239733036c3a3d8813a8ec472e045f5f5b60100055441414c540374776fdc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba15888ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a147013e239733036c3a3d8813a8ec472e045f5f5b60100055441414c540374776fdd5a1e00000000001976a914c6be9b874f1f44e5a4cd0617698aa3259b0b08bd88ac00000000";
  splitTxObj = new bsv.Transaction(splitHex);
}

function getMergeSplitUtxo(splitTxObj) {
  return [
    {
      tx: splitTxObj,
      scriptPubKey: scriptPubKey,
      vout: 0,
    },
    {
      tx: splitTxObj,
      scriptPubKey: scriptPubKey,
      vout: 1,
    },
  ];
}

const expectedHex =
  "010000000324890cbac183e64770f94cded7d3d89ada9127d6e5ee3af164c0f967b2b41cb700000000fde20902e8031469517ff3b4d1cf991a263489a49078b118492f3002d0071469517ff3b4d1cf991a263489a49078b118492f3003c3840114fe5697f24aa6e72a1d5f034121156a81d4f46f955120f9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c145126dd5a1e00000000001976a914c6be9b874f1f44e5a4cd0617698aa3259b0b08bd88ac0000000022dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba1584d5901b80b000000000000ffffffff02423b5f2837239035dff6eaf19c81ee1ccd777e95cf708e36a2b5d2a3931558000000004100000047304402203af4c26c8722d2594469a5ce339b45917d1c4ecd813e6096aec4a895eb1f6d2f02202b6436a21b95d0a46f5004bdaee66f441ff983d49b64fd802538134c2ae8901a412102a3afcd9527b6f3ccfd68f17ae19852168c5202033cff542e6609f567bbe9c1aeffffffff2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21010000006b483045022100df74bfdede946cd441c5b8e3ed8bd48c1fa14a5c0a660b2ca3c1d95101241ca3022064f4d1528f2769122343a3c9172f709288f29a54a81f6caf745fb2f63c6f4868412102ce376e38ef5393d0c20f8cc5e4b7958a50d25dac0287cde2b9e192a0d0815035ffffffff03dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba1584d1d0101000000022b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fd1b0702dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15802dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15803dd5a1e14c6be9b874f1f44e5a4cd0617698aa3259b0b08bd51202b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21004d420601000000a881e572ca976dc6ef3ff647c8c58762ff55d8174cfa3f502b1411e8bbcd286e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632ad2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fda30576a914c0f1de1ee32943002b5b6ab55469c8a74eed7823544d420601000000bdc0b59a0f5c5a6e5a5b131d51cd1249ac66f89cb3f2b1902766ffd30fc76db582a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be824890cbac183e64770f94cded7d3d89ada9127d6e5ee3af164c0f967b2b41cb700000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba15888ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a147013e239733036c3a3d8813a8ec472e045f5f5b60100055441414c540374776fdc05000000000000ffffffff85bc2e978ecf593b4fe0a21ef0d455e32eaaeb3c2699f5a67f8020ad23a717990000000041000000473044022055e532214ffe84c84dfa41636e859baddb3f8869592aafd0fbaecdd54ab4d20602207520e12d3aaebbbeb3e69a59254e233c12e1fafaaf6f69c02f36483cef900c4a41210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffff24890cbac183e64770f94cded7d3d89ada9127d6e5ee3af164c0f967b2b41cb701000000fde20902e8031469517ff3b4d1cf991a263489a49078b118492f3002d0071469517ff3b4d1cf991a263489a49078b118492f3003c3840114fe5697f24aa6e72a1d5f034121156a81d4f46f955120f9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c140026dd5a1e00000000001976a914c6be9b874f1f44e5a4cd0617698aa3259b0b08bd88ac0000000022dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba1584d5901b80b000000000000ffffffff02423b5f2837239035dff6eaf19c81ee1ccd777e95cf708e36a2b5d2a3931558000000004100000047304402203af4c26c8722d2594469a5ce339b45917d1c4ecd813e6096aec4a895eb1f6d2f02202b6436a21b95d0a46f5004bdaee66f441ff983d49b64fd802538134c2ae8901a412102a3afcd9527b6f3ccfd68f17ae19852168c5202033cff542e6609f567bbe9c1aeffffffff2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21010000006b483045022100df74bfdede946cd441c5b8e3ed8bd48c1fa14a5c0a660b2ca3c1d95101241ca3022064f4d1528f2769122343a3c9172f709288f29a54a81f6caf745fb2f63c6f4868412102ce376e38ef5393d0c20f8cc5e4b7958a50d25dac0287cde2b9e192a0d0815035ffffffff03dc05000000000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba1584d1d0101000000022b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fd1b0702dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15802dc0514586e3f2e59ab13983310d9d7b3ddd0cf61dba15803dd5a1e14c6be9b874f1f44e5a4cd0617698aa3259b0b08bd51202b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de21004d420601000000a881e572ca976dc6ef3ff647c8c58762ff55d8174cfa3f502b1411e8bbcd286e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632ad2b3c89e464996422b63f65ac25f6fadc51cf4d81773b9b9bb69509388fd5de2100000000fda30576a914c0f1de1ee32943002b5b6ab55469c8a74eed7823544d420601000000bdc0b59a0f5c5a6e5a5b131d51cd1249ac66f89cb3f2b1902766ffd30fc76db582a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be824890cbac183e64770f94cded7d3d89ada9127d6e5ee3af164c0f967b2b41cb701000000fda30576a914586e3f2e59ab13983310d9d7b3ddd0cf61dba15888ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a147013e239733036c3a3d8813a8ec472e045f5f5b60100055441414c540374776fdc05000000000000ffffffff85bc2e978ecf593b4fe0a21ef0d455e32eaaeb3c2699f5a67f8020ad23a71799000000004100000047304402206fdfd234fb2d598705fa966a2c3fe7cfe113605cf0519b04a9b3e472e4ead3ca022010f6c1316950ce14c4f9b762516890b37424c1f51a5c667cc4080e12522e9a0741210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1fffffffff9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c14010000006b483045022100f9a5e54961217f5b46769f43f561059dd1d9d3c86cffa5b797718bc26e19606c02205c6867f92eebffee9dbae7039354ac3b585732308c8e4dd249b037202da34f2641210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffff03e803000000000000fda30576a91469517ff3b4d1cf991a263489a49078b118492f3088ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14b161f6b2cb286542249ca8c8f835f6c150c222b90100055441414c540374776fd007000000000000fda30576a91469517ff3b4d1cf991a263489a49078b118492f3088ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14b161f6b2cb286542249ca8c8f835f6c150c222b90100055441414c540374776fc3840100000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac00000000";

const scriptPubKey =
  "76a9144cb280a3d3d26353af3f79b5d1555dedb6b2d0f688ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14b161f6b2cb286542249ca8c8f835f6c150c222b90100055441414c540374776f";

function getMergeUTxoDiffData() {
  mergeObj = new bsv.Transaction(mergeHexDiffData);
  return [
    {
      tx: mergeObj,
      scriptPubKey: scriptPubKey,
      vout: 0,
    },
    {
      tx: mergeObj,
      scriptPubKey: scriptPubKey,
      vout: 1,
    },
  ];
}

function getMergeUTxoDiffOwner() {
  mergeObj = new bsv.Transaction(mergeUtxoDiffOwner);
  return [
    {
      tx: mergeObj,
      scriptPubKey: scriptPubKey,
      vout: 0,
    },
    {
      tx: mergeObj,
      scriptPubKey: scriptPubKey,
      vout: 1,
    },
  ];
}

const mergeHexDiffData =
  "0100000002f2cd970f0419a809f5fe93f02db8fc38afc6296ce813cf49d227a27483fc2517000000006a47304402200822d0b34839dc23704e6a6b4a2ae504b82c4b75fcd0dfe0e3fb2e590b1a27ea02203210cabb086471acd4fb137c309971ea532744c7a5bf420f15aff831fd74f8e7412103c2e86b5117128a5198d4df4bf098037ad55c3aa8d4630dfaa33b03b73a981385fffffffff2cd970f0419a809f5fe93f02db8fc38afc6296ce813cf49d227a27483fc2517010000006a473044022054ffe6058583f7455769d44b625617e6a53b17a3678aa08cc580f611d1831cbe02202406388c234ecbab1cb3d5889e94ec0c3509b635e31ee8dd619cf723d6798ac741210316916d6c3f3662bba417eee93b48d2eb1072a90307aa0171ae957df968ee087bffffffff03581b000000000000fda30576a9147a6d05f7fad33d35b15d75391d58cfbddf966dad88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a144ac2384d246c4f80af8f47b6bbb5f3318fd3d97d0100055441414c54036f6e65b80b000000000000fda30576a9147a6d05f7fad33d35b15d75391d58cfbddf966dad88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a144ac2384d246c4f80af8f47b6bbb5f3318fd3d97d0100055441414c540374776f875c1e00000000001976a9144e74944377d68442fb34d8fc24f91b982999b62b88ac00000000";

const mergeUtxoDiffOwner =
  "0100000002ea11dbec2bac8e729ba5c20886a77a32da6064a91740b9f962a90e84d133ea69000000006b483045022100df687f424d728bb9a721793a89da41a1d6c56864e68c9a0c7e99eb0f9fc162280220224447c4b241fc0bb4bd434d77e5458e42a3efd5fec5717ef4e98bdbd3e6c4eb41210330210e18e7b196f6f001b13c55f2ab67e60f80ccfc7c1488e034298a0c49bcdfffffffffea11dbec2bac8e729ba5c20886a77a32da6064a91740b9f962a90e84d133ea69010000006b483045022100a64b24ec3f0827d602c1ecb70a73a1fed73b92dc179b60c478b2197a865c7b0b022026eea0355de7488fe02eb83c5f17ffa9bbdc8d699f0f2c5482aebfcf4a0d9e44412103491b4f432f1e19fa45a4b0b4975949225b17aaaad853501c7b5af2475f9868b8ffffffff03581b000000000000fd9f0576a914848d5483f2c426022b87f315b117b0366a21827688ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a1493e5cbb63e70f8a5168bac9486388fd06a7192d30100055441414c54b80b000000000000fd9f0576a914d162a6f9d0c866f210eb16c050dfbb02dc87fd8688ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a1493e5cbb63e70f8a5168bac9486388fd06a7192d30100055441414c54885c1e00000000001976a9147cc7bbe6b8c397a69a7f80f9acab46bc90a1ebdb88ac00000000";
