const bsv = require("bsv");
const { sighash } = require("../../lib/stas");
const { merge, mergeWithCallback, unsignedMerge } = require("../../index");
const privatekeyStr = "Ky5XHRQvYEcEbtGoQQQETbctAgAQKvb3PocfJSnkyHuEj5Nzj1pb";
const privateKey = new bsv.PrivateKey(privatekeyStr);
const expectedHex =
  "01000000036f07e73f648a5c78a808c900e241ba7c170e0de3a6072a3af05d718434614efe00000000fdcc0902581b1469517ff3b4d1cf991a263489a49078b118492f30030c850114fe5697f24aa6e72a1d5f034121156a81d4f46f955120f9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c1451268d5b1e00000000001976a9144ee998083f91f9aa2e9dc98697f1507d7c35b66c88ac0000000022ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a4d5a01581b000000000000ffffffff35cb313e3d3ca03d662b1e1166eea02cff9058cb88778fc05bf2638befcc2a1a0000000041000000483045022100f43eb6c90743e6114805aef9928c66e244d6346f7da6e3505225cd2d29eb55c2022056796bd802d560af0f8a6017b7e16fafed76bf871f45905f5a581374d4ebb8bb412102c690cab7963241136bf291c3c94aabb8810f6538fb889c2eda3d153e597ec34affffffffcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838020000006b483045022100dd03300a0562587660a3fbcaa7c0e6e999a273376d466e767c0e36c2a589b54f02200968aeceeffad85596308accbd84673acf70cc541f1df57eaaece39080d56bd5412103ea4665a46c0bb41fc4ee0971477d5dadbaff82577724bb0290761d9434e60d75ffffffff03ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a4d1d010100000002cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fd1c0702ac0d1487e4affc4d9c210a9fdac0226581657650d1520a02ac0d1487e4affc4d9c210a9fdac0226581657650d1520a038d5b1e144ee998083f91f9aa2e9dc98697f1507d7c35b66c5220cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838004d420601000000d72f96b9ebe220fdc0167213da1c288a7880bfaeecacb9ce3e06b54a1938209e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632adcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fda30576a9147cf6bc2b063d71f5ed0ce2393d16de4d760668c7544d420601000000cbf8e138d24414e91b508bb0176f843ae83dc465f23c1779d980f7cf983b54ad82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be86f07e73f648a5c78a808c900e241ba7c170e0de3a6072a3af05d718434614efe00000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e65ac0d000000000000ffffffff7b3cb2821775dfdb3e96d7d9248eb35b09d80e92bf5f44e3d7afeb020375246200000000410000004830450221009b2c835ab9c0d87666e0d05f9b892f2812b245c8f156b55ee67a51d5032515c002207d81092781df75cfd3682d1bb33af2e9a28fd8f77a7f22f8d77ccb48db81e7bf41210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffff6f07e73f648a5c78a808c900e241ba7c170e0de3a6072a3af05d718434614efe01000000fdcb0902581b1469517ff3b4d1cf991a263489a49078b118492f30030c850114fe5697f24aa6e72a1d5f034121156a81d4f46f955120f9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c1400268d5b1e00000000001976a9144ee998083f91f9aa2e9dc98697f1507d7c35b66c88ac0000000022ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a4d5a01581b000000000000ffffffff35cb313e3d3ca03d662b1e1166eea02cff9058cb88778fc05bf2638befcc2a1a0000000041000000483045022100f43eb6c90743e6114805aef9928c66e244d6346f7da6e3505225cd2d29eb55c2022056796bd802d560af0f8a6017b7e16fafed76bf871f45905f5a581374d4ebb8bb412102c690cab7963241136bf291c3c94aabb8810f6538fb889c2eda3d153e597ec34affffffffcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838020000006b483045022100dd03300a0562587660a3fbcaa7c0e6e999a273376d466e767c0e36c2a589b54f02200968aeceeffad85596308accbd84673acf70cc541f1df57eaaece39080d56bd5412103ea4665a46c0bb41fc4ee0971477d5dadbaff82577724bb0290761d9434e60d75ffffffff03ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a4d1d010100000002cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fd1c0702ac0d1487e4affc4d9c210a9fdac0226581657650d1520a02ac0d1487e4affc4d9c210a9fdac0226581657650d1520a038d5b1e144ee998083f91f9aa2e9dc98697f1507d7c35b66c5220cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838004d420601000000d72f96b9ebe220fdc0167213da1c288a7880bfaeecacb9ce3e06b54a1938209e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632adcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fda30576a9147cf6bc2b063d71f5ed0ce2393d16de4d760668c7544d420601000000cbf8e138d24414e91b508bb0176f843ae83dc465f23c1779d980f7cf983b54ad82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be86f07e73f648a5c78a808c900e241ba7c170e0de3a6072a3af05d718434614efe01000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e65ac0d000000000000ffffffff7b3cb2821775dfdb3e96d7d9248eb35b09d80e92bf5f44e3d7afeb02037524620000000041000000473044022005424fb9029a126227c2c81b57740e4b0b7c91c914b1bbb29336a76115e1e9690220015fdb2dc90df19f5ea1c3b220ba19ed8fce170c7761cd974431640fb37c27f941210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1fffffffff9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c14010000006b483045022100a70426a48b51bea2c733de122f5712a518c0cf1c5e1d7d49ceaabdde3d2ee14802204ccc1d803eae58ceed8c123c987af032897089c2204e3c6447b764896df3f27041210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffff02581b000000000000fda30576a91469517ff3b4d1cf991a263489a49078b118492f3088ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e650c850100000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac00000000";
let addr = "mq7psuJ7Z9h1w4H3YtcCoHx7cPmhVM9UsV";
let splitTxObj;
let fundingUtxo = {
  txid: "148c762dca1aa6e6c55fbd7fe0b3cdc00e3f21d7f1304b2349365cfb91bfe5f9",
  vout: 1,
  scriptPubKey: "76a914d1b44a79bbfd9bbcdae85f042ffcb5bc042363f188ac",
  satoshis: 100000,
};

const ownerSignatureCallback = async (tx, i, script, satoshis) => {
  return bsv.Transaction.sighash
    .sign(tx, privateKey, sighash, i, script, satoshis)
    .toTxFormat()
    .toString("hex");
};

beforeAll(() => {
  setup();
});

describe("Merge Unit Tests", () => {
  it("should create merge", async () => {
    const hex = await merge(
      privateKey,
      getMergeUtxo(splitTxObj),
      addr,
      fundingUtxo,
      privateKey
    );
    expect(hex).toBe(expectedHex);
  });

  it("should fail with null token owner public key", async () => {
    expect(() =>
      merge(
        null,
        getMergeUtxo(splitTxObj),
        addr,
        fundingUtxo,
        privateKey.publicKey
      )
    ).toThrow("Token owner private key is null");
  });
});

describe("unsignedMerge unit tests", () => {
  it("unsignedMerge returns tx hex", async () => {
    const expectedHex =
      "01000000036f07e73f648a5c78a808c900e241ba7c170e0de3a6072a3af05d718434614efe00000000fd610902581b1469517ff3b4d1cf991a263489a49078b118492f30030c850114fe5697f24aa6e72a1d5f034121156a81d4f46f955120f9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c1451268d5b1e00000000001976a9144ee998083f91f9aa2e9dc98697f1507d7c35b66c88ac0000000022ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a4d5a01581b000000000000ffffffff35cb313e3d3ca03d662b1e1166eea02cff9058cb88778fc05bf2638befcc2a1a0000000041000000483045022100f43eb6c90743e6114805aef9928c66e244d6346f7da6e3505225cd2d29eb55c2022056796bd802d560af0f8a6017b7e16fafed76bf871f45905f5a581374d4ebb8bb412102c690cab7963241136bf291c3c94aabb8810f6538fb889c2eda3d153e597ec34affffffffcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838020000006b483045022100dd03300a0562587660a3fbcaa7c0e6e999a273376d466e767c0e36c2a589b54f02200968aeceeffad85596308accbd84673acf70cc541f1df57eaaece39080d56bd5412103ea4665a46c0bb41fc4ee0971477d5dadbaff82577724bb0290761d9434e60d75ffffffff03ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a4d1d010100000002cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fd1c0702ac0d1487e4affc4d9c210a9fdac0226581657650d1520a02ac0d1487e4affc4d9c210a9fdac0226581657650d1520a038d5b1e144ee998083f91f9aa2e9dc98697f1507d7c35b66c5220cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838004d420601000000d72f96b9ebe220fdc0167213da1c288a7880bfaeecacb9ce3e06b54a1938209e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632adcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fda30576a9147cf6bc2b063d71f5ed0ce2393d16de4d760668c7544d420601000000cbf8e138d24414e91b508bb0176f843ae83dc465f23c1779d980f7cf983b54ad82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be86f07e73f648a5c78a808c900e241ba7c170e0de3a6072a3af05d718434614efe00000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e65ac0d000000000000ffffffff7b3cb2821775dfdb3e96d7d9248eb35b09d80e92bf5f44e3d7afeb02037524620000000041000000ffffffff6f07e73f648a5c78a808c900e241ba7c170e0de3a6072a3af05d718434614efe01000000fd610902581b1469517ff3b4d1cf991a263489a49078b118492f30030c850114fe5697f24aa6e72a1d5f034121156a81d4f46f955120f9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c1400268d5b1e00000000001976a9144ee998083f91f9aa2e9dc98697f1507d7c35b66c88ac0000000022ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a4d5a01581b000000000000ffffffff35cb313e3d3ca03d662b1e1166eea02cff9058cb88778fc05bf2638befcc2a1a0000000041000000483045022100f43eb6c90743e6114805aef9928c66e244d6346f7da6e3505225cd2d29eb55c2022056796bd802d560af0f8a6017b7e16fafed76bf871f45905f5a581374d4ebb8bb412102c690cab7963241136bf291c3c94aabb8810f6538fb889c2eda3d153e597ec34affffffffcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838020000006b483045022100dd03300a0562587660a3fbcaa7c0e6e999a273376d466e767c0e36c2a589b54f02200968aeceeffad85596308accbd84673acf70cc541f1df57eaaece39080d56bd5412103ea4665a46c0bb41fc4ee0971477d5dadbaff82577724bb0290761d9434e60d75ffffffff03ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a4d1d010100000002cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fd1c0702ac0d1487e4affc4d9c210a9fdac0226581657650d1520a02ac0d1487e4affc4d9c210a9fdac0226581657650d1520a038d5b1e144ee998083f91f9aa2e9dc98697f1507d7c35b66c5220cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838004d420601000000d72f96b9ebe220fdc0167213da1c288a7880bfaeecacb9ce3e06b54a1938209e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632adcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fda30576a9147cf6bc2b063d71f5ed0ce2393d16de4d760668c7544d420601000000cbf8e138d24414e91b508bb0176f843ae83dc465f23c1779d980f7cf983b54ad82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be86f07e73f648a5c78a808c900e241ba7c170e0de3a6072a3af05d718434614efe01000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e65ac0d000000000000ffffffff7b3cb2821775dfdb3e96d7d9248eb35b09d80e92bf5f44e3d7afeb02037524620000000041000000fffffffff9e5bf91fb5c3649234b30f1d7213f0ec0cdb3e07fbd5fc5e6a61aca2d768c140100000000ffffffff02581b000000000000fda30576a91469517ff3b4d1cf991a263489a49078b118492f3088ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e650c850100000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac00000000";
    const res = await unsignedMerge(
      privateKey.publicKey,
      getMergeUtxo(splitTxObj),
      addr,
      fundingUtxo,
      privateKey.publicKey
    );
    expect(res.hex).toBe(expectedHex);
  });
});

// to do merge different owners
describe("MergeWithCallBack Unit Tests", () => {
  it("should create hex mergeWithCallback", async () => {
    const hex = await mergeWithCallback(
      privateKey.publicKey,
      getMergeUtxo(splitTxObj),
      addr,
      fundingUtxo,
      privateKey.publicKey,
      ownerSignatureCallback,
      ownerSignatureCallback
    );
    expect(hex).toBe(expectedHex);
  });

  it("should fail with more than two merge utxos", async () => {
    let mergeUtxo = getMergeUtxo(splitTxObj);
    mergeUtxo.push({
      tx: splitTxObj,
      vout: 2,
    });
    await expect(() =>
      mergeWithCallback(
        privateKey.publicKey,
        mergeUtxo,
        addr,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("This function can only merge exactly 2 STAS tokens");
  });

  it("should fail with less than two merge utxos", async () => {
    let mergeUtxo = [
      {
        tx: splitTxObj,
        vout: 0,
      },
    ];
    await expect(() =>
      mergeWithCallback(
        privateKey.publicKey,
        mergeUtxo,
        addr,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("This function can only merge exactly 2 STAS tokens");
  });

  it("should fail when merging with different data", async () => {
    await expect(() =>
      mergeWithCallback(
        privateKey.publicKey,
        getMergeUTxoDiffData(),
        addr,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow(
      "This function only merges utxos with identical data properties"
    );
  });

  it("should fail with null token owner public key", async () => {
    await expect(() =>
      mergeWithCallback(
        null,
        getMergeUtxo(splitTxObj),
        addr,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("Token owner public key is null");
  });

  it("should fail with null funding public key", async () => {
    await expect(() =>
      mergeWithCallback(
        privateKey,
        getMergeUtxo(splitTxObj),
        addr,
        fundingUtxo,
        null,
        ownerSignatureCallback,
        ownerSignatureCallback
      )
    ).rejects.toThrow("Payment UTXO provided but payment key is null");
  });

  it("should fail with null merge utxos", async () => {
    await expect(() =>
      mergeWithCallback(
        privateKey.publicKey,
        null,
        addr,
        fundingUtxo,
        privateKey.publicKey,
        ownerSignatureCallback
      )
    ).rejects.toThrow("MergeUtxos is invalid");
  });

  test.each([
    { addr: null, error: "Destination address is null" },
    {
      addr: "1MSCReQT9E4GpxuK1K7uyD5q",
      error: "Invalid Address string provided",
    },
    {
      addr: "1MSCReQT9E4GpxuK1K7uyD5qF1EmznXjkrmoFCgGtkmhyaL2frwff84p2bwTf3F",
      error: "Checksum mismatch",
    },
  ])(
    "should fail with invalid destination address",
    async ({ addr, error }) => {
      await expect(() =>
        mergeWithCallback(
          privateKey.publicKey,
          getMergeUtxo(splitTxObj),
          addr,
          fundingUtxo,
          privateKey.publicKey,
          ownerSignatureCallback
        )
      ).rejects.toThrow(error);
    }
  );
});

function setup() {
  const splitHex =
    "0100000002cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fd1c0702ac0d1487e4affc4d9c210a9fdac0226581657650d1520a02ac0d1487e4affc4d9c210a9fdac0226581657650d1520a038d5b1e144ee998083f91f9aa2e9dc98697f1507d7c35b66c5220cda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838004d420601000000d72f96b9ebe220fdc0167213da1c288a7880bfaeecacb9ce3e06b54a1938209e752adad0a7b9ceca853768aebb6965eca126a62965f698a0c1bc43d83db632adcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd183800000000fda30576a9147cf6bc2b063d71f5ed0ce2393d16de4d760668c788ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e65581b000000000000ffffffff35cb313e3d3ca03d662b1e1166eea02cff9058cb88778fc05bf2638befcc2a1a0000000041000000483045022100f43eb6c90743e6114805aef9928c66e244d6346f7da6e3505225cd2d29eb55c2022056796bd802d560af0f8a6017b7e16fafed76bf871f45905f5a581374d4ebb8bb412102c690cab7963241136bf291c3c94aabb8810f6538fb889c2eda3d153e597ec34affffffffcda1e36caacfb63dd7a1ef434926054570ef2f6ca3e9f97ed2de20c84abd1838020000006b483045022100dd03300a0562587660a3fbcaa7c0e6e999a273376d466e767c0e36c2a589b54f02200968aeceeffad85596308accbd84673acf70cc541f1df57eaaece39080d56bd5412103ea4665a46c0bb41fc4ee0971477d5dadbaff82577724bb0290761d9434e60d75ffffffff03ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e65ac0d000000000000fda30576a91487e4affc4d9c210a9fdac0226581657650d1520a88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a146539f01fa291f4f7384e9ff38a5508a0249635190100055441414c54036f6e658d5b1e00000000001976a9144ee998083f91f9aa2e9dc98697f1507d7c35b66c88ac00000000";
  splitTxObj = new bsv.Transaction(splitHex);
}

function getMergeUtxo(mergeObj) {
  return [
    {
      tx: mergeObj,
      vout: 0,
    },
    {
      tx: mergeObj,
      vout: 1,
    },
  ];
}

function getMergeUTxoDiffData() {
  mergeObj = new bsv.Transaction(
    "0100000002a02512bdcb1594a640da7e41358173016655cca6418e7f3a3b81b7306ae6e163000000006a47304402202ef300aa565726e7ff7039f5902c2d95c1b5d3f3e34f48f657219889b22613be022050e8f805fdc6e88c2f9dfcf546b3b7c3f6a1c45079df8f15144672665590523741210295c6163f319609858e900d2d7c1996ccb9ce35d351ba6b6797783223b28fb930ffffffffa02512bdcb1594a640da7e41358173016655cca6418e7f3a3b81b7306ae6e163010000006b483045022100e2303959d7fb9b75864422871253df752195ba02fda915fbe38f038ac1fe2c24022048b764bd26a0672cbddb05678170a58ad141ba30bf219f763d0e088dbebb866e41210315b004f6e2ec17b941c0ea598ab2fe33c1dff719ed008841faefc009d5255c23ffffffff03581b000000000000fda30576a914fc41f8fa9fc932a20c3be45077b7462aa88c016f88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a145efa67650275636b1bb3c5a3cdad6976428272500100055441414c54036f6e65b80b000000000000fda30576a914fc41f8fa9fc932a20c3be45077b7462aa88c016f88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a145efa67650275636b1bb3c5a3cdad6976428272500100055441414c540374776f875c1e00000000001976a9147e40f90ad0aad87293c50767b3d999df1efb74c788ac00000000"
  );
  return [
    {
      tx: mergeObj,
      vout: 0,
    },
    {
      tx: mergeObj,
      vout: 1,
    },
  ];
}
