const bsv = require('bsv')
const { sighash } = require('../../lib/stas')
const {
    swap
} = require('../../index')
const {
    createSwapOffer,
    acceptSwapOffer,
    createUnsignedSwapOffer,
    acceptUnsignedSwapOffer,
    acceptUnsignedNativeSwapOffer,
    makerSignSwapOffer
  } = require('../../index').swap
const privateKeyStr = 'Ky5XHRQvYEcEbtGoQQQETbctAgAQKvb3PocfJSnkyHuEj5Nzj1pb'
const privateKey = new bsv.PrivateKey(privateKeyStr)
const txHex = '01000000028bf8a4e77f7648f9e838060daca70eaf73ba28605539da0d3bc320f35554c8d8000000006a47304402202d429d964a2c2de32a45bd7f0edf20c53723adc8d8ff2cb206a28dfb87cc637e022069265d63287621ed9e208570e0ca407830c2ea2e49d80f5802a6c54550f9a049412103c3c7cb498f8e866cff7fe2445553b76c58b0c35504c47f16b846ead1168f7581ffffffff8bf8a4e77f7648f9e838060daca70eaf73ba28605539da0d3bc320f35554c8d8010000006a47304402206144cedb1a2b6d2494b9e5eddc550f4cbf5742aa76146c654364dc0ed928fcc802205c0a45b3f2f2fffb52bd393d40b9ef5ea680a9b87ad989fc4884edc7fc6680c2412102c1966eaeeab6eff206f04f0946c698f35f4ef86dd39361f23a7e447acd2e8c49ffffffff02b80b000000000000fda40576a914a67a3c236e723db5defb08c5427a1141f819771688ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a148314c4b3d45ee62bcccdedd48d374c120f765cda010006544f4b454e42036f6e6528781e00000000001976a914df00a360a841a42c8b7e4610137fe1f920089f1c88ac00000000'
const inputStasTx = bsv.Transaction(txHex)
let makerInputUtxo = {
        txId: '04e8013ecfc5958e4bce37fd3b6bd1366985d1f4338d6a76307920d91ff3cfae',
        outputIndex: 0,
        script: inputStasTx.outputs[0].script,
        satoshis: 1000
}
let wantedInfo = { type: 'native', satoshis: 1000 }
const hex = '01000000015e95597fe3f27fb00f0d33734fc62199e549fbde69b8569bed716dadc5547bd9000000006a4730440220113f7efe82e865d42673bc942b24c1fe54a437e8ccfb818509e24d4ea76e781b02202635e73e56f867cfba5c741fd5a8e9764b6026402ffa94168c2f492ad88a121cc32102f6151d3a7cf7de559baf54521bafc083ca1b043360409bf9bff0ea8e52503356ffffffff0140420f00000000001976a914649e80851dda9543baa29b4463665e360959ffbf88ac00000000'
const pubkeyhash = '649e80851dda9543baa29b4463665e360959ffbf'
const fundingUTXO = {
    txid: '04e8013ecfc5958e4bce37fd3b6bd1366985d1f4338d6a76307920d91ff3cfae',
    vout: 1,
    scriptPubKey: '76a914f6a1124c57b05b7c2544750d4241c90f15b6837b88ac',
    satoshis: 1000
  }
  const vout = 0

describe('createSwap unit tests', () => {

    const expectedHex = '0100000001aecff31fd9207930766a8d33f4d1856936d16b3bfd37ce4b8e95c5cf3e01e804000000006a47304402201ae6ab709cbf76bf52698ac263cf0a51c9addb1738e55b8b114b916a28e1d74b022068d40e744179cfcfce2be3d49bba130c903c125d36ef6c75f6c85cd7e06c1c56c3210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffff01e8030000000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac00000000'

    beforeEach(() => 
        makerInputUtxo.script = inputStasTx.outputs[0].script       
    )

    it('createSwap offer returns tx hex', () => {

        const res = createSwapOffer(privateKey, makerInputUtxo, wantedInfo)
        expect(res).toBe(expectedHex)    
    })

    it('should fail with empty offerScript', () => {
        makerInputUtxo.script = ''
        expect(() => createSwapOffer(privateKey, makerInputUtxo, wantedInfo))
    })

    it('should fail with non object offerScript', () => {
        makerInputUtxo.script = 'notAnObject'
        expect(() => createSwapOffer(privateKey, makerInputUtxo, wantedInfo)).toThrow('makerInputUtxo.script must be an object')
    })

    it('should fail with null maker private key', () => {
        expect(() => createSwapOffer(null, makerInputUtxo, wantedInfo)).toThrow('Maker private key is null')
    })

    it('should fail with null inputUtxo', () => {
        expect(() => createSwapOffer(privateKey, null, wantedInfo)).toThrow('Maker input UTXO is null')
    })
})

describe('acceptSwapOffer unit tests', () => {
    
    const expectedHex = '01000000035e95597fe3f27fb00f0d33734fc62199e549fbde69b8569bed716dadc5547bd9000000006a4730440220113f7efe82e865d42673bc942b24c1fe54a437e8ccfb818509e24d4ea76e781b02202635e73e56f867cfba5c741fd5a8e9764b6026402ffa94168c2f492ad88a121cc32102f6151d3a7cf7de559baf54521bafc083ca1b043360409bf9bff0ea8e52503356ffffffff81d253d68a53175d827581e214c67d44996a2498a08ec6a955faedb732318a55000000006b483045022100a58319309af7a1a24d0c048e8fe455201090d40d60a95d237548f29baf73dd1502203a6057722a3d274fb6e32b5a4e86b23fc7edefaadc2225d6a3600c04168b296241210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffffaecff31fd9207930766a8d33f4d1856936d16b3bfd37ce4b8e95c5cf3e01e8040100000069463043021f378b36e9d81bddefedf4151c1d716ce31002644b4b2aef4fc772ccaee20f9d022033e3786c78b94e9e3fb65d7a96948f6646f27df8913e109cdf785f90410ce03b41210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffff0340420f00000000001976a914649e80851dda9543baa29b4463665e360959ffbf88ace8030000000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588acc4030000000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac00000000'

    it('acceptSwapOffer should return tx hex', () => {
        const res = acceptSwapOffer(hex, hex, privateKey, hex, makerInputUtxo, 1000, pubkeyhash, fundingUTXO, privateKey)
        expect(res).toBe(expectedHex)
    })

    it('acceptSwapOffer with null offerhex', () => {
        expect(() => acceptSwapOffer(null, hex, privateKey, hex, makerInputUtxo, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('offerTxHex is null')
    })

    it('acceptSwapOffer with null makerInputHex', () => {
        expect(() => acceptSwapOffer(hex, null, privateKey, hex, makerInputUtxo, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('makerInputTxHex is null')
    })

    it('acceptSwapOffer with null takerPrivateKey', () => {
        expect(() => acceptSwapOffer(hex, hex, null, hex, makerInputUtxo, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerPrivateKey is null')
    })

    it('acceptSwapOffer with null takerInputHex', () => {
        expect(() => acceptSwapOffer(hex, hex, privateKey, null, makerInputUtxo, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputTxHex is null')
    })

    it('acceptSwapOffer with null takerInputUTXO', () => {
        expect(() => acceptSwapOffer(hex, hex, privateKey, privateKey, null, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputUTXO is null')
    })

    it('acceptSwapOffer with null takerOutputSatoshis', () => {
        expect(() => acceptSwapOffer(hex, hex, privateKey, privateKey, makerInputUtxo, null, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerOutputSatoshis must be greater than zero')
    })

    it('acceptSwapOffer with zero takerOutputSatoshis', () => {
        expect(() => acceptSwapOffer(hex, hex, privateKey, privateKey, makerInputUtxo, 0, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerOutputSatoshis must be greater than zero')
    })

    it('acceptSwapOffer with null makerPublicKeyHash', () => {
        expect(() => acceptSwapOffer(hex, hex, privateKey, privateKey, makerInputUtxo, 1000, null, fundingUTXO, privateKey)).toThrow('makerPublicKeyHash is null')
    })

    it('acceptSwapOffer with null paymentUtxo', () => {
        expect(() => acceptSwapOffer(hex, hex, privateKey, privateKey, makerInputUtxo, 1000, pubkeyhash, null, privateKey)).toThrow('paymentUtxo is null')
    })

    it('acceptSwapOffer with null paymentPrivateKey', () => {
        expect(() => acceptSwapOffer(hex, hex, privateKey, privateKey, makerInputUtxo, 1000, pubkeyhash, fundingUTXO, null)).toThrow('paymentPrivateKey is null')
    })
})

describe('createUnsignedOffer unit tests', () => {
    
    const expectedHex = '0100000001aecff31fd9207930766a8d33f4d1856936d16b3bfd37ce4b8e95c5cf3e01e8040000000000ffffffff01e8030000000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac00000000'
    afterEach(() => 
        wantedInfo.type = 'native'  
    )   
    
    it('createUnsignedOffer should return tx hex', () => {
        const res = createUnsignedSwapOffer(privateKey, makerInputUtxo, wantedInfo)
        expect(res).toBe(expectedHex)
    })

    it('should fail with wrong wantedInfo type', () => {
        wantedInfo.type = 'incorrectType'
        expect(() => createUnsignedSwapOffer(privateKey, makerInputUtxo, wantedInfo)).toThrow('wantedInfo.type must be undefined or "native"')
    })

    it('createUnsignedOffer makerPrivateyKey is null', () => {
        expect(() => createUnsignedSwapOffer(null, makerInputUtxo, wantedInfo)).toThrow('makerPrivateKey is null')
    })

    it('createUnsignedOffer makerInputUtxo is null', () => {
        expect(() => createUnsignedSwapOffer(privateKey, null, wantedInfo)).toThrow('makerInputUTXO is null')
    })

    it('createUnsignedOffer wantedInfo is null', () => {
        expect(() => createUnsignedSwapOffer(privateKey, makerInputUtxo, null)).toThrow('wantedInfo is null')
    })
})

describe('acceptUnsignedSwapOffer unit tests', () => {

     const offerTxHex = '010000000117146e978b58efdd2e31b6569105b717902c44aa435eab5c3edbcede927038460000000000ffffffff017017000000000000fda40576a914d56fce603699a5c2e3d8209a35d0dbaa2e90598388ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14a0e03515fbcffba05118c2c08d53124a60f9a585010006544f4b454e41036f6e6500000000'
     const makerInputTxHex = '0100000002c252295e9ba38405b01357715da16931ca6605f5bd7721a9e3bebedc5ffe96d5000000006b483045022100b7dbe07964c6f2cf7fe6a43a5d2022598edf78dc9d3f86b940c6d2c526c3d8b502204fe201dbfb3c007c50f760fb37975f7ea80d53fa9ea77fbcb112629f0090bd914121023625b23112a592371df5ea8dae77cd767b4ae60edf894813b7e2c3d56656164bffffffffc252295e9ba38405b01357715da16931ca6605f5bd7721a9e3bebedc5ffe96d5010000006a4730440220621b36ce450e186f9139037257c99142675c64665d37a95c146744c0ca59871902207b87bf3bd8ef52338af9dfdb7bb88c48f2ad8347338c2ac7055508bc7b3978874121032de108b9a1fbb910989c7414d8639f96656fce59ea51b021461a25b8b3378a1dffffffff02b80b000000000000fda40576a914d56fce603699a5c2e3d8209a35d0dbaa2e90598388ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14d6bfdedb61a293eee8fee59b785eb889add6011c010006544f4b454e42036f6e6528781e00000000001976a914408985b20bf87fb82d8be5c2b39b03e2f11432aa88ac00000000'
     const takerInputTxHex = '01000000022461e524bca587a7c327fe6b24a33335d280042c5c58cf645596ec2cf2e178eb000000006a47304402205168a3fb0b076bbe51844ef12411eb3eeb771417204294566baaaf8fbb35d23d02203252f9719eae743a8fd8fd451bd70e6b017471d41b9dfc07b6ed6caa25da49434121032a4ab01aae8e2d39fac36c879ac1ec22cee6b6b8ec5426632f93392653a83b2fffffffff2461e524bca587a7c327fe6b24a33335d280042c5c58cf645596ec2cf2e178eb010000006b483045022100e2f39845a15948a58e2e05d2eb43e3d058fefd00b0f1366d19bed2af904aa0ad0220336f7c6f90884eaa0903c61f9c5114e539fb0f86202c40a808564175a62ae2bd4121032de108b9a1fbb910989c7414d8639f96656fce59ea51b021461a25b8b3378a1dffffffff027017000000000000fda40576a9146135ee3bdeb31900c0277e410b7379e61e73768388ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14a0e03515fbcffba05118c2c08d53124a60f9a585010006544f4b454e41036f6e65706c1e00000000001976a914408985b20bf87fb82d8be5c2b39b03e2f11432aa88ac00000000'
     expectedHex = '010000000317146e978b58efdd2e31b6569105b717902c44aa435eab5c3edbcede927038460000000000ffffffff116641409e11ecfbf4715292ec5019c0982b5e7ff07ad965fb23af29d6f204e300000000fd210e02701714649e80851dda9543baa29b4463665e360959ffbf02e80314fe5697f24aa6e72a1d5f034121156a81d4f46f9502950114fe5697f24aa6e72a1d5f034121156a81d4f46f955120aecff31fd9207930766a8d33f4d1856936d16b3bfd37ce4b8e95c5cf3e01e804004d02070100000002c252295e9ba38405b01357715da16931ca6605f5bd7721a9e3bebedc5ffe96d5000000006b483045022100b7dbe07964c6f2cf7fe6a43a5d2022598edf78dc9d3f86b940c6d2c526c3d8b502204fe201dbfb3c007c50f760fb37975f7ea80d53fa9ea77fbcb112629f0090bd914121023625b23112a592371df5ea8dae77cd767b4ae60edf894813b7e2c3d56656164bffffffffc252295e9ba38405b01357715da16931ca6605f5bd7721a9e3bebedc5ffe96d5010000006a4730440220621b36ce450e186f9139037257c99142675c64665d37a95c146744c0ca59871902207b87bf3bd8ef52338af9dfdb7bb88c48f2ad8347338c2ac7055508bc7b3978874121032de108b9a1fbb910989c7414d8639f96656fce59ea51b021461a25b8b3378a1dffffffff02b80b000000000000fda40576a914d56fce603699a5c2e3d8209a35d0dbaa2e90598388ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14d6bfdedb61a293eee8fee59b785eb889add6011c010006544f4b454e42036f6e6528781e00000000001976a914408985b20bf87fb82d8be5c2b39b03e2f11432aa88ac00000000514d430601000000b78710e55f3f85aec7de262da9ae25bb1c84309df340e6041cd393d3d8d52a0582a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be8116641409e11ecfbf4715292ec5019c0982b5e7ff07ad965fb23af29d6f204e300000000fda40576a9146135ee3bdeb31900c0277e410b7379e61e73768388ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14a0e03515fbcffba05118c2c08d53124a60f9a585010006544f4b454e41036f6e65e803000000000000ffffffff0158a20aa0ac4cbb20b15449e7cc764e0a7a7130beada8597c71ec68893243d10000000041000000473044022039a829ecb0cee9536377be1c97ef232f8040641f072db5a5dd10f1f8ffe4491802206f22e4c3af651be70d642f561dad58b19f462a3c7babda7f8264da718a2fe1d241210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffffaecff31fd9207930766a8d33f4d1856936d16b3bfd37ce4b8e95c5cf3e01e804010000006b48304502210084fc354fca421b22c211e20f549ca894f2028bd340272392b4bbfc4d24b7fac502202f0b95cf877ba6d6967868c6daf5ea3cc7465fbb48831e5b620c41dc9e768c9241210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffff037017000000000000fda40576a914d56fce603699a5c2e3d8209a35d0dbaa2e90598388ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14a0e03515fbcffba05118c2c08d53124a60f9a585010006544f4b454e41036f6e65e803000000000000fda40576a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14d6bfdedb61a293eee8fee59b785eb889add6011c010006544f4b454e42036f6e6595010000000000001976a914fe5697f24aa6e72a1d5f034121156a81d4f46f9588ac00000000'

    it('acceptUnsignedSwapOffer should return tx hex', () => {
        const res = acceptUnsignedSwapOffer(offerTxHex, makerInputTxHex, privateKey, takerInputTxHex, vout, 1000, 1000, pubkeyhash, fundingUTXO, privateKey)
        expect(res).toBe(expectedHex)
    })

    it('acceptUnsignedSwapOffer with null offerhex', () => {
        expect(() => acceptUnsignedSwapOffer(null, hex, privateKey, hex, vout, 1000, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('offerTxHex is null')
    })

    it('acceptUnsignedSwapOffer with null makerInputTxHex', () => {
        expect(() => acceptUnsignedSwapOffer(hex, null, privateKey, hex, vout, 1000, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('makerInputTxHex is null')
    })

    it('acceptUnsignedSwapOffer with null takerPrivateKey', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, null, hex, vout, 1000, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerPrivateKey is null')
    })

    it('acceptUnsignedSwapOffer with null takerInputHex', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, null, vout, 1000, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputTxHex is null')
    })

    it('acceptUnsignedSwapOffer with null takerInputUTXO', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, hex, null, 1000, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputVout is null')
    })

    it('acceptUnsignedSwapOffer with null takerOutputSatoshis', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, hex, vout, null, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputSatoshis must be greater than zero')
    })

    it('acceptUnsignedSwapOffer with zero takerOutputSatoshis', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, hex, vout, 0, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputSatoshis must be greater than zero')
    })

    it('acceptUnsignedSwapOffer with zero takerOutputSatoshis', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, hex, vout, 1000, 0, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerOutputSatoshis must be greater than zero')
    })

    it('acceptUnsignedSwapOffer with null takerOutputSatoshis', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, hex, vout, 1000, null, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerOutputSatoshis must be greater than zero')
    })

    it('acceptUnsignedSwapOffer with null makerPublicKeyHash', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, hex, vout, 1000, 1000, null, fundingUTXO, privateKey)).toThrow('makerPublicKeyHash is null')
    })

    it('acceptUnsignedSwapOffer with null paymentUtxo', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, hex, vout, 1000, 1000, pubkeyhash, null, privateKey)).toThrow('paymentUtxo is null')
    })

    it('acceptUnsignedSwapOffer with null paymentPrivateKey', () => {
        expect(() => acceptUnsignedSwapOffer(hex, hex, privateKey, hex, vout, 1000, 1000, pubkeyhash, fundingUTXO, null)).toThrow('paymentPrivateKey is null')
    })
})

describe('acceptUnsignedNativeSwapOffer unit tests', () => {

    it('acceptUnsignedSwapOffer with null offerhex', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(null, wantedInfo, hex, privateKey, hex, vout, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('offerTxHex is null')
    })

    it('acceptUnsignedSwapOffer with null takerInputInfo', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, null, hex, privateKey, hex, vout, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputInfo is null')
    })

    it('acceptUnsignedSwapOffer with null makerInputTxHex', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, wantedInfo, null, privateKey, hex, vout, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('makerInputTxHex is null')
    })

    it('acceptUnsignedSwapOffer with null takerPrivateKey', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, wantedInfo, hex, null, hex, vout, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerPrivateKey is null')
    })

    it('acceptUnsignedSwapOffer with null takerInputTxHex', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, wantedInfo, hex, privateKey, null, vout, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputTxHex is null')
    })

    it('acceptUnsignedSwapOffer with null takerInputVout', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, wantedInfo, hex, privateKey, hex, null, 1000, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerInputVout is null')
    })

    it('acceptUnsignedSwapOffer with null takerOutputSatoshis', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, wantedInfo, hex, privateKey, hex, vout, null, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerOutputSatoshis must be greater than zero')
    })

    it('acceptUnsignedSwapOffer with zero takerOutputSatoshis', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, wantedInfo, hex, privateKey, hex, vout, 0, pubkeyhash, fundingUTXO, privateKey)).toThrow('takerOutputSatoshis must be greater than zero')
    })

    it('acceptUnsignedSwapOffer with null paymentUtxo', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, wantedInfo, hex, privateKey, hex, vout, 1000, pubkeyhash, null, privateKey)).toThrow('paymentUtxo is null')
    })

    it('acceptUnsignedSwapOffer with null paymentPrivateKey', () => {
        expect(() =>  acceptUnsignedNativeSwapOffer(hex, wantedInfo, hex, privateKey, hex, vout, 1000, pubkeyhash, fundingUTXO, null)).toThrow('paymentPrivateKey is null')
    })
})

describe('makerSignSwapOffer unit tests', () => {
    const offerTxHex = '01000000034355eb6992cf0ee6510130e9ee076e24e732283ba66310fce0a9cf7afe9beec90000000000ffffffffd7ef6c721a529cb78f3625a563360be4e5b9f27fae55b97e42d28301d212514a00000000fd240e02701714ff36a35862419b1ae51cd718238c79eadb5e8d7e02b80b1487f3c32557c620f69e24d3bf43ef708ed7a189ff03d5751e141657cfecf56831d2b8606bf07465b3c2d5f19d6d51204355eb6992cf0ee6510130e9ee076e24e732283ba66310fce0a9cf7afe9beec9004d0307010000000284f98837234fd565321f6c95bd7f57705fe7600245021e78b9124dccb130f148000000006b483045022100c3dbd183c77acf465155aa91fbdd6472d79f2c60f682b8af400c1decda8309af02201e706f2d2c0a7d74cee719804b1891f26cd03cf2e480d9e65fa1db39006e78b3412103c7f00eff7c4a4b370e0b4a19f3a07d84348ba48db9e7a07488ce30d186468809ffffffff84f98837234fd565321f6c95bd7f57705fe7600245021e78b9124dccb130f148010000006b483045022100da04fb033e6be618ba65de7cce4a91117056d2306fd9b0324a9f46cae19413bc022043f6af9bd0e8afe7f9d3f8287999f65fc3ff0508fa437a007eb3e4ed8abb8d00412102d01fb062220684382846b085f890f83125fa2caedad265fbf31c1870d3139686ffffffff02b80b000000000000fda40576a914ff36a35862419b1ae51cd718238c79eadb5e8d7e88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14f1705836c9f2a7d0c2451c44407e067faef76568010006544f4b454e42036f6e6528781e00000000001976a9141657cfecf56831d2b8606bf07465b3c2d5f19d6d88ac00000000514d4306010000004aa38119f3dfd20039b4d29f4367d18ef7e7886d649479ee9072737c705edfbe82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be8d7ef6c721a529cb78f3625a563360be4e5b9f27fae55b97e42d28301d212514a00000000fda40576a91487f3c32557c620f69e24d3bf43ef708ed7a189ff88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14757fc56ed2bb7b3401d4028073c51d0be28c8e9f010006544f4b454e41036f6e657017000000000000ffffffff27dff66b18c1bd2dbd11a95546f50aab1ec03cf0ddb846ac0cd6d5fbd3ccebbe00000000410000004830450221009502862302afd3dccbad77fdbc41b44108e3a4fa893f3ebaaaf98dd16d2bc956022017a90c85fb446a163c2063060b0934cd1ae32541d4a8a02110713d59cbd46c7941210253d08594c14bdb549d3a2374f166701c5fbbc536b4e162eb0c756201586f4b73ffffffff4355eb6992cf0ee6510130e9ee076e24e732283ba66310fce0a9cf7afe9beec9010000006b483045022100d3c015743ee357916fa4ae2f08e57987da12f92b9a8d02681e9d0c58204c7eb502205c253e78c36ae751c899502e214ee60e360a771dce3d9ab9ccbf0b0336104ae7412102d01fb062220684382846b085f890f83125fa2caedad265fbf31c1870d3139686ffffffff037017000000000000fda40576a914ff36a35862419b1ae51cd718238c79eadb5e8d7e88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14757fc56ed2bb7b3401d4028073c51d0be28c8e9f010006544f4b454e41036f6e65b80b000000000000fda40576a91487f3c32557c620f69e24d3bf43ef708ed7a189ff88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14f1705836c9f2a7d0c2451c44407e067faef76568010006544f4b454e42036f6e65d5751e00000000001976a9141657cfecf56831d2b8606bf07465b3c2d5f19d6d88ac00000000'
    const makerInputTxHex = '010000000284f98837234fd565321f6c95bd7f57705fe7600245021e78b9124dccb130f148000000006b483045022100c3dbd183c77acf465155aa91fbdd6472d79f2c60f682b8af400c1decda8309af02201e706f2d2c0a7d74cee719804b1891f26cd03cf2e480d9e65fa1db39006e78b3412103c7f00eff7c4a4b370e0b4a19f3a07d84348ba48db9e7a07488ce30d186468809ffffffff84f98837234fd565321f6c95bd7f57705fe7600245021e78b9124dccb130f148010000006b483045022100da04fb033e6be618ba65de7cce4a91117056d2306fd9b0324a9f46cae19413bc022043f6af9bd0e8afe7f9d3f8287999f65fc3ff0508fa437a007eb3e4ed8abb8d00412102d01fb062220684382846b085f890f83125fa2caedad265fbf31c1870d3139686ffffffff02b80b000000000000fda40576a914ff36a35862419b1ae51cd718238c79eadb5e8d7e88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14f1705836c9f2a7d0c2451c44407e067faef76568010006544f4b454e42036f6e6528781e00000000001976a9141657cfecf56831d2b8606bf07465b3c2d5f19d6d88ac00000000'
    const takerInputTx = '010000000228a79d6ab30f06429f8ccede9e8bf8c066467bebcae69a5549f25c6c1badc897000000006a473044022011d20b01165d68e53943aa6d68bb3c9db18eed45723938fc430ee399be5590090220452554ee3aa3f4078649d96bfb19bf6879aac8329b7759085570da6fac2cb8614121020c1e03f7e732d3b284535b9a13a7aea8904253e23b1d9671f1b224c9248e532fffffffff28a79d6ab30f06429f8ccede9e8bf8c066467bebcae69a5549f25c6c1badc897010000006b483045022100a9a57eb3263139b19bf6b78526405814496c60f8972a9762b1e56241632e68600220309efe9568ccda9983843b1da3b08e5d184a9ed72d8341a9b0eb22dff6325239412102d01fb062220684382846b085f890f83125fa2caedad265fbf31c1870d3139686ffffffff027017000000000000fda40576a91487f3c32557c620f69e24d3bf43ef708ed7a189ff88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14757fc56ed2bb7b3401d4028073c51d0be28c8e9f010006544f4b454e41036f6e65706c1e00000000001976a9141657cfecf56831d2b8606bf07465b3c2d5f19d6d88ac00000000'
    const expectedHex = '01000000034355eb6992cf0ee6510130e9ee076e24e732283ba66310fce0a9cf7afe9beec900000000fd220e02701714fe5697f24aa6e72a1d5f034121156a81d4f46f9502b80b14649e80851dda9543baa29b4463665e360959ffbf03d5751e14649e80851dda9543baa29b4463665e360959ffbf5120aecff31fd9207930766a8d33f4d1856936d16b3bfd37ce4b8e95c5cf3e01e804004d0207010000000228a79d6ab30f06429f8ccede9e8bf8c066467bebcae69a5549f25c6c1badc897000000006a473044022011d20b01165d68e53943aa6d68bb3c9db18eed45723938fc430ee399be5590090220452554ee3aa3f4078649d96bfb19bf6879aac8329b7759085570da6fac2cb8614121020c1e03f7e732d3b284535b9a13a7aea8904253e23b1d9671f1b224c9248e532fffffffff28a79d6ab30f06429f8ccede9e8bf8c066467bebcae69a5549f25c6c1badc897010000006b483045022100a9a57eb3263139b19bf6b78526405814496c60f8972a9762b1e56241632e68600220309efe9568ccda9983843b1da3b08e5d184a9ed72d8341a9b0eb22dff6325239412102d01fb062220684382846b085f890f83125fa2caedad265fbf31c1870d3139686ffffffff027017000000000000fda40576a91487f3c32557c620f69e24d3bf43ef708ed7a189ff88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14757fc56ed2bb7b3401d4028073c51d0be28c8e9f010006544f4b454e41036f6e65706c1e00000000001976a9141657cfecf56831d2b8606bf07465b3c2d5f19d6d88ac00000000514d4306010000004aa38119f3dfd20039b4d29f4367d18ef7e7886d649479ee9072737c705edfbe82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be84355eb6992cf0ee6510130e9ee076e24e732283ba66310fce0a9cf7afe9beec900000000fda40576a914ff36a35862419b1ae51cd718238c79eadb5e8d7e88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14f1705836c9f2a7d0c2451c44407e067faef76568010006544f4b454e42036f6e65b80b000000000000ffffffff27dff66b18c1bd2dbd11a95546f50aab1ec03cf0ddb846ac0cd6d5fbd3ccebbe000000004100000047304402207e19af3761f5103657df420a5a71829d6a259ad39462fe646b35a27d6d79bf5f0220025c15f61af49e527b993914a7ac63bdaf36a75163faaf1fd77fa5932d9bf69641210270d2ae2d5eb30c142347b26b2b4684145b6934d7964127637eaf9ace366945b1ffffffffd7ef6c721a529cb78f3625a563360be4e5b9f27fae55b97e42d28301d212514a00000000fd240e02701714ff36a35862419b1ae51cd718238c79eadb5e8d7e02b80b1487f3c32557c620f69e24d3bf43ef708ed7a189ff03d5751e141657cfecf56831d2b8606bf07465b3c2d5f19d6d51204355eb6992cf0ee6510130e9ee076e24e732283ba66310fce0a9cf7afe9beec9004d0307010000000284f98837234fd565321f6c95bd7f57705fe7600245021e78b9124dccb130f148000000006b483045022100c3dbd183c77acf465155aa91fbdd6472d79f2c60f682b8af400c1decda8309af02201e706f2d2c0a7d74cee719804b1891f26cd03cf2e480d9e65fa1db39006e78b3412103c7f00eff7c4a4b370e0b4a19f3a07d84348ba48db9e7a07488ce30d186468809ffffffff84f98837234fd565321f6c95bd7f57705fe7600245021e78b9124dccb130f148010000006b483045022100da04fb033e6be618ba65de7cce4a91117056d2306fd9b0324a9f46cae19413bc022043f6af9bd0e8afe7f9d3f8287999f65fc3ff0508fa437a007eb3e4ed8abb8d00412102d01fb062220684382846b085f890f83125fa2caedad265fbf31c1870d3139686ffffffff02b80b000000000000fda40576a914ff36a35862419b1ae51cd718238c79eadb5e8d7e88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14f1705836c9f2a7d0c2451c44407e067faef76568010006544f4b454e42036f6e6528781e00000000001976a9141657cfecf56831d2b8606bf07465b3c2d5f19d6d88ac00000000514d4306010000004aa38119f3dfd20039b4d29f4367d18ef7e7886d649479ee9072737c705edfbe82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be8d7ef6c721a529cb78f3625a563360be4e5b9f27fae55b97e42d28301d212514a00000000fda40576a91487f3c32557c620f69e24d3bf43ef708ed7a189ff88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14757fc56ed2bb7b3401d4028073c51d0be28c8e9f010006544f4b454e41036f6e657017000000000000ffffffff27dff66b18c1bd2dbd11a95546f50aab1ec03cf0ddb846ac0cd6d5fbd3ccebbe00000000410000004830450221009502862302afd3dccbad77fdbc41b44108e3a4fa893f3ebaaaf98dd16d2bc956022017a90c85fb446a163c2063060b0934cd1ae32541d4a8a02110713d59cbd46c7941210253d08594c14bdb549d3a2374f166701c5fbbc536b4e162eb0c756201586f4b73ffffffff4355eb6992cf0ee6510130e9ee076e24e732283ba66310fce0a9cf7afe9beec9010000006b483045022100d3c015743ee357916fa4ae2f08e57987da12f92b9a8d02681e9d0c58204c7eb502205c253e78c36ae751c899502e214ee60e360a771dce3d9ab9ccbf0b0336104ae7412102d01fb062220684382846b085f890f83125fa2caedad265fbf31c1870d3139686ffffffff037017000000000000fda40576a914ff36a35862419b1ae51cd718238c79eadb5e8d7e88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14757fc56ed2bb7b3401d4028073c51d0be28c8e9f010006544f4b454e41036f6e65b80b000000000000fda40576a91487f3c32557c620f69e24d3bf43ef708ed7a189ff88ac6976aa607f5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7c5f7f7c5e7f7c5d7f7c5c7f7c5b7f7c5a7f7c597f7c587f7c577f7c567f7c557f7c547f7c537f7c527f7c517f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01007e818b21414136d08c5ed2bf3ba048afe6dcaebafeffffffffffffffffffffffffffffff007d976e7c5296a06394677768827601249301307c7e23022079be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798027e7c7e7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c8276638c687f7c7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e7e01417e21038ff83d8cf12121491609c4939dc11c4aa35503508fe432dc5a5c1905608b9218ad547f7701207f01207f7701247f517f7801007e8102fd00a063546752687f7801007e817f727e7b01177f777b557a766471567a577a786354807e7e676d68aa880067765158a569765187645294567a5379587a7e7e78637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6878637c8c7c53797e577a7e6867567a6876aa587a7d54807e577a597a5a7a786354807e6f7e7eaa727c7e676d6e7eaa7c687b7eaa587a7d877663516752687c72879b69537a647500687c7b547f77517f7853a0916901247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77788c6301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f777852946301247f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e816854937f77686877517f7c52797d8b9f7c53a09b91697c76638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6876638c7c587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f777c6863587f77517f7c01007e817602fc00a06302fd00a063546752687f7c01007e81687f7768587f517f7801007e817602fc00a06302fd00a063546752687f7801007e81727e7b7b687f75537f7c0376a9148801147f775379645579887567726881766968789263556753687a76026c057f7701147f8263517f7c766301007e817f7c6775006877686b537992635379528763547a6b547a6b677c6b567a6b537a7c717c71716868547a587f7c81547a557964936755795187637c686b687c547f7701207f75748c7a7669765880748c7a76567a876457790376a9147e7c7e557967041976a9147c7e0288ac687e7e5579636c766976748c7a9d58807e6c0376a9147e748c7a7e6c7e7e676c766b8263828c007c80517e846864745aa0637c748c7a76697d937b7b58807e56790376a9147e748c7a7e55797e7e6868686c567a5187637500678263828c007c80517e846868647459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e687459a0637c748c7a76697d937b7b58807e55790376a9147e748c7a7e55797e7e68687c537a9d547963557958807e041976a91455797e0288ac7e7e68aa87726d77776a14f1705836c9f2a7d0c2451c44407e067faef76568010006544f4b454e42036f6e65d5751e00000000001976a9141657cfecf56831d2b8606bf07465b3c2d5f19d6d88ac00000000'
    
    it('makerSignSwapOffer returns valid hex', () => {
        const res = makerSignSwapOffer(offerTxHex, makerInputTxHex, takerInputTx, privateKey, pubkeyhash, pubkeyhash, fundingUTXO)
        expect(res).toBe(expectedHex)
    })

    it('makerSignSwapOffer with null offerTxHex', () => {
        expect(() =>  makerSignSwapOffer(null, makerInputTxHex, takerInputTx, privateKey, pubkeyhash, pubkeyhash, fundingUTXO)).toThrow('offerTxHex is null')
    })

    it('makerSignSwapOffer with null makerInputTxHex', () => {
        expect(() =>  makerSignSwapOffer(hex, null, takerInputTx, privateKey, pubkeyhash, pubkeyhash, fundingUTXO)).toThrow('makerInputTxHex is null')
    })

    it('makerSignSwapOffer with null takerInputTx', () => {
        expect(() =>  makerSignSwapOffer(hex, makerInputTxHex, null, privateKey, pubkeyhash, pubkeyhash, fundingUTXO)).toThrow('takerInputTx is null')
    })

    it('makerSignSwapOffer with null makerPrivateKey', () => {
        expect(() =>  makerSignSwapOffer(hex, makerInputTxHex, takerInputTx, null, pubkeyhash, pubkeyhash, fundingUTXO)).toThrow('makerPrivateKey is null')
    })

    it('makerSignSwapOffer with null takerPublicKeyHash', () => {
        expect(() =>  makerSignSwapOffer(hex, makerInputTxHex, takerInputTx, privateKey, null, pubkeyhash, fundingUTXO)).toThrow('takerPublicKeyHash is null')
    })

    it('makerSignSwapOffer with null paymentPublicKeyHash', () => {
        expect(() =>  makerSignSwapOffer(hex, makerInputTxHex, takerInputTx, privateKey, pubkeyhash, null, fundingUTXO)).toThrow('paymentPublicKeyHash is null')
    })

    it('makerSignSwapOffer with null paymentUtxo', () => {
        expect(() =>  makerSignSwapOffer(hex, makerInputTxHex, takerInputTx, privateKey, pubkeyhash, pubkeyhash, null)).toThrow('paymentUtxo is null')
    })
})
    

describe('handleChangeForSwap unit tests', () => {
        //tests
})